---
title: "Business Forecasting for fish production in United States"
output: html_notebook
author: "Vallabh Sawant, Gaurav Vishwakarma, Rakshit Karkera"
---


```{r}
library(fpp)

FP_US <- read_excel("Fish_Production_UnitedStates.xlsx")
View(FP_US)
```

```{r}
FP_US_TS <- ts(FP_US$`Capture fisheries production (metric tons)`, start = c(1960))
FP_US_TS
```

```{r}
class(FP_US_TS)
plot(FP_US_TS)
```

```{r}
summary(FP_US)
```

```{r}
Acf(FP_US_TS)
```

```{r}
snaive_forecast = snaive(FP_US_TS,5)
plot (snaive_forecast)
lines(snaive_forecast$mean, col = 'Red')
```
```{r}
#Trend and Seasonality missing - no beta and no gamma
FP_US_TS_ETS = ets(FP_US_TS)
FP_US_TS_ETS
FP_US_TS_HW = HoltWinters(FP_US_TS,beta=FALSE,gamma=FALSE)
FP_US_TS_HW
```
###The output of HoltWinters() tells us that the estimated value of the alpha parameter is about 0.99992. This is very close to one, telling us that the forecasts are based on both recent observations and have more weight than the less recent forecasts.

###By default, HoltWinters() just makes forecasts for the same time period covered by our original time series. In this case, our original time series included fish capture for United States from 1960-2016, so the forecasts are also for 1960-2016.

###The forecasts made by HoltWinters() can be accessed by using fitted.

```{r}
FP_TP_US_HW$fitted
```

```{r}
plot(FP_TP_US_HW)
```

###The plot shows the original time series in black, and the forecasts as a red line. The time series of forecasts is the same as the time series of the original data here.

###As a measure of the accuracy of the forecasts, we can calculate the sum of squared errors for the in-sample forecast errors, that is, the forecast errors for the time period covered by our original time series. 

```{r}
FP_TP_US_HW$SSE
```

###That is, here the sum-of-squared-errors is 3.194019e+12.

###You can specify the initial value for the level in the HoltWinters() function by using the “l.start” parameter. For example, to make forecasts with the initial value of the level set to 2714623 , we type:

```{r}
HoltWinters(FP_US_TS, beta=FALSE, gamma=FALSE, l.start=2714623)
```
###As explained above, by default HoltWinters() just makes forecasts for the time period covered by the original data, which is 1960-2016 for the Fish Production time series. We can make forecasts for further time points by using the forecast function on  the HoltWinters() model. 

```{r}
library("forecast")
```


###Forecasting on Holts winter model.

```{r}
FP_US_TS2 <- forecast(FP_US_TS_HW, h=3)
FP_US_TS2
```

###The forecast function gives you the forecast for a year, a 80% prediction interval for the forecast, and a 95% prediction interval for the forecast. In the above example, the forecasted fish production for 2019 is 4931026, with a 95% prediction interval of (4124303, 5737750).


###Plot the predictions made by HoltWinters():
```{r}
plot(FP_US_TS2)
```


```{r}
FP_US_SMA3 <- SMA(FP_US_TS,n=3)
plot.ts(FP_US_SMA3)
```

```{r}
FP_US_SMA8 <- SMA(FP_US_TS,n=8)
plot.ts(FP_US_SMA8)
```


